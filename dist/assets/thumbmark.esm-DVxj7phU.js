const U="https://api.thumbmarkjs.com",O={exclude:[],include:[],stabilize:["private","iframe"],logging:!0,timeout:5e3,cache_api_call:!0,performance:!1,experimental:!1},H={private:[{exclude:["canvas"],browsers:["firefox","safari>=17","brave"]},{exclude:["audio"],browsers:["samsungbrowser","safari"]},{exclude:["fonts"],browsers:["firefox"]},{exclude:["audio.sampleHash","hardware.deviceMemory","header.acceptLanguage.q","system.hardwareConcurrency","plugins"],browsers:["brave"]},{exclude:["tls.extensions"],browsers:["firefox","chrome","safari"]},{exclude:["header.acceptLanguage"],browsers:["edge","chrome"]}],iframe:[{exclude:["permissions.camera","permission.geolocation","permissions.microphone","system.applePayVersion","system.cookieEnabled"],browsers:["safari"]}],vpn:[{exclude:["ip"]}]};function z(n){let o=0;for(let t=0;t<n.length;++t)o+=Math.abs(n[t]);return o}function _(n,o,t){let r=[];for(let s=0;s<n[0].data.length;s++){let e=[];for(let u=0;u<n.length;u++)e.push(n[u].data[s]);r.push(K(e))}const c=new Uint8ClampedArray(r);return new ImageData(c,o,t)}function K(n){if(n.length===0)return 0;const o={};for(const r of n)o[r]=(o[r]||0)+1;let t=n[0];for(const r in o)o[r]>o[t]&&(t=parseInt(r,10));return t}function I(n){return n^=n>>>16,n=Math.imul(n,2246822507),n^=n>>>13,n=Math.imul(n,3266489909),(n^=n>>>16)>>>0}const y=new Uint32Array([597399067,2869860233,951274213,2716044179]);function b(n,o){return n<<o|n>>>32-o}function x(n,o=0){var t;if(o=o?0|o:0,typeof n=="string"&&(t=n,n=new TextEncoder().encode(t).buffer),!(n instanceof ArrayBuffer))throw new TypeError("Expected key to be ArrayBuffer or string");const r=new Uint32Array([o,o,o,o]);(function(s,e){const u=s.byteLength/16|0,l=new Uint32Array(s,0,4*u);for(let i=0;i<u;i++){const a=l.subarray(4*i,4*(i+1));a[0]=Math.imul(a[0],y[0]),a[0]=b(a[0],15),a[0]=Math.imul(a[0],y[1]),e[0]=e[0]^a[0],e[0]=b(e[0],19),e[0]=e[0]+e[1],e[0]=Math.imul(e[0],5)+1444728091,a[1]=Math.imul(a[1],y[1]),a[1]=b(a[1],16),a[1]=Math.imul(a[1],y[2]),e[1]=e[1]^a[1],e[1]=b(e[1],17),e[1]=e[1]+e[2],e[1]=Math.imul(e[1],5)+197830471,a[2]=Math.imul(a[2],y[2]),a[2]=b(a[2],17),a[2]=Math.imul(a[2],y[3]),e[2]=e[2]^a[2],e[2]=b(e[2],15),e[2]=e[2]+e[3],e[2]=Math.imul(e[2],5)+2530024501,a[3]=Math.imul(a[3],y[3]),a[3]=b(a[3],18),a[3]=Math.imul(a[3],y[0]),e[3]=e[3]^a[3],e[3]=b(e[3],13),e[3]=e[3]+e[0],e[3]=Math.imul(e[3],5)+850148119}})(n,r),(function(s,e){const u=s.byteLength/16|0,l=s.byteLength%16,i=new Uint32Array(4),a=new Uint8Array(s,16*u,l);switch(l){case 15:i[3]=i[3]^a[14]<<16;case 14:i[3]=i[3]^a[13]<<8;case 13:i[3]=i[3]^a[12],i[3]=Math.imul(i[3],y[3]),i[3]=b(i[3],18),i[3]=Math.imul(i[3],y[0]),e[3]=e[3]^i[3];case 12:i[2]=i[2]^a[11]<<24;case 11:i[2]=i[2]^a[10]<<16;case 10:i[2]=i[2]^a[9]<<8;case 9:i[2]=i[2]^a[8],i[2]=Math.imul(i[2],y[2]),i[2]=b(i[2],17),i[2]=Math.imul(i[2],y[3]),e[2]=e[2]^i[2];case 8:i[1]=i[1]^a[7]<<24;case 7:i[1]=i[1]^a[6]<<16;case 6:i[1]=i[1]^a[5]<<8;case 5:i[1]=i[1]^a[4],i[1]=Math.imul(i[1],y[1]),i[1]=b(i[1],16),i[1]=Math.imul(i[1],y[2]),e[1]=e[1]^i[1];case 4:i[0]=i[0]^a[3]<<24;case 3:i[0]=i[0]^a[2]<<16;case 2:i[0]=i[0]^a[1]<<8;case 1:i[0]=i[0]^a[0],i[0]=Math.imul(i[0],y[0]),i[0]=b(i[0],15),i[0]=Math.imul(i[0],y[1]),e[0]=e[0]^i[0]}})(n,r),(function(s,e){e[0]=e[0]^s.byteLength,e[1]=e[1]^s.byteLength,e[2]=e[2]^s.byteLength,e[3]=e[3]^s.byteLength,e[0]=e[0]+e[1]|0,e[0]=e[0]+e[2]|0,e[0]=e[0]+e[3]|0,e[1]=e[1]+e[0]|0,e[2]=e[2]+e[0]|0,e[3]=e[3]+e[0]|0,e[0]=I(e[0]),e[1]=I(e[1]),e[2]=I(e[2]),e[3]=I(e[3]),e[0]=e[0]+e[1]|0,e[0]=e[0]+e[2]|0,e[0]=e[0]+e[3]|0,e[1]=e[1]+e[0]|0,e[2]=e[2]+e[0]|0,e[3]=e[3]+e[0]|0})(n,r);const c=new Uint8Array(r.buffer);return Array.from(c).map((s=>s.toString(16).padStart(2,"0"))).join("")}const B=280;function q(n,o){return new Promise((t=>setTimeout(t,n,o)))}const J=["Arial","Arial Black","Arial Narrow","Arial Rounded MT","Arimo","Archivo","Barlow","Bebas Neue","Bitter","Bookman","Calibri","Cabin","Candara","Century","Century Gothic","Comic Sans MS","Constantia","Courier","Courier New","Crimson Text","DM Mono","DM Sans","DM Serif Display","DM Serif Text","Dosis","Droid Sans","Exo","Fira Code","Fira Sans","Franklin Gothic Medium","Garamond","Geneva","Georgia","Gill Sans","Helvetica","Impact","Inconsolata","Indie Flower","Inter","Josefin Sans","Karla","Lato","Lexend","Lucida Bright","Lucida Console","Lucida Sans Unicode","Manrope","Merriweather","Merriweather Sans","Montserrat","Myriad","Noto Sans","Nunito","Nunito Sans","Open Sans","Optima","Orbitron","Oswald","Pacifico","Palatino","Perpetua","PT Sans","PT Serif","Poppins","Prompt","Public Sans","Quicksand","Rajdhani","Recursive","Roboto","Roboto Condensed","Rockwell","Rubik","Segoe Print","Segoe Script","Segoe UI","Sora","Source Sans Pro","Space Mono","Tahoma","Taviraj","Times","Times New Roman","Titillium Web","Trebuchet MS","Ubuntu","Varela Round","Verdana","Work Sans"],Y=["monospace","sans-serif","serif"];function D(n,o){if(!n)throw new Error("Canvas context not supported");return n.font=`72px ${o}`,n.measureText("WwMmLli0Oo").width}function X(){var n;const o=document.createElement("canvas"),t=(n=o.getContext("webgl"))!==null&&n!==void 0?n:o.getContext("experimental-webgl");if(t&&"getParameter"in t)try{const r=(t.getParameter(t.VENDOR)||"").toString(),c=(t.getParameter(t.RENDERER)||"").toString();let s={vendor:r,renderer:c,version:(t.getParameter(t.VERSION)||"").toString(),shadingLanguageVersion:(t.getParameter(t.SHADING_LANGUAGE_VERSION)||"").toString()};if(!c.length||!r.length){const e=t.getExtension("WEBGL_debug_renderer_info");if(e){const u=(t.getParameter(e.UNMASKED_VENDOR_WEBGL)||"").toString(),l=(t.getParameter(e.UNMASKED_RENDERER_WEBGL)||"").toString();u&&(s.vendorUnmasked=u),l&&(s.rendererUnmasked=l)}}return s}catch{}return"undefined"}function Z(){const n=new Float32Array(1),o=new Uint8Array(n.buffer);return n[0]=1/0,n[0]=n[0]-n[0],o[3]}const k=(n,o,t,r)=>{const c=(t-o)/r;let s=0;for(let e=0;e<r;e++)s+=n(o+(e+.5)*c);return s*c};function Q(n,o){const t={};return o.forEach((r=>{const c=(function(s){if(s.length===0)return null;const e={};s.forEach((i=>{const a=String(i);e[a]=(e[a]||0)+1}));let u=s[0],l=1;return Object.keys(e).forEach((i=>{e[i]>l&&(u=i,l=e[i])})),u})(n.map((s=>r in s?s[r]:void 0)).filter((s=>s!==void 0)));c&&(t[r]=c)})),t}const ee=["accelerometer","accessibility","accessibility-events","ambient-light-sensor","background-fetch","background-sync","bluetooth","camera","clipboard-read","clipboard-write","device-info","display-capture","gyroscope","geolocation","local-fonts","magnetometer","microphone","midi","nfc","notifications","payment-handler","persistent-storage","push","speaker","storage-access","top-level-storage-access","window-management","query"];function L(){var n,o,t,r,c,s;if(typeof navigator>"u")return{name:"unknown",version:"unknown"};const e=navigator.userAgent,u=[/(?<name>SamsungBrowser)\/(?<version>\d+(?:\.\d+)+)/,/(?<name>EdgA|EdgiOS|Edg)\/(?<version>\d+(?:\.\d+)+)/,/(?<name>OPR|OPX)\/(?<version>\d+(?:\.\d+)+)/,/Opera[\s\/](?<version>\d+(?:\.\d+)+)/,/Opera Mini\/(?<version>\d+(?:\.\d+)+)/,/Opera Mobi\/(?<version>\d+(?:\.\d+)+)/,/(?<name>Vivaldi)\/(?<version>\d+(?:\.\d+)+)/,/(?<name>Brave)\/(?<version>\d+(?:\.\d+)+)/,/(?<name>CriOS)\/(?<version>\d+(?:\.\d+)+)/,/(?<name>FxiOS)\/(?<version>\d+(?:\.\d+)+)/,/(?<name>Chrome|Chromium)\/(?<version>\d+(?:\.\d+)+)/,/(?<name>Firefox|Waterfox|Iceweasel|IceCat)\/(?<version>\d+(?:\.\d+)+)/,/Version\/(?<version1>[\d.]+).*Safari\/[\d.]+|(?<name>Safari)\/(?<version2>[\d.]+)/,/(?<name>MSIE|Trident|IEMobile).+?(?<version>\d+(?:\.\d+)+)/,/(?<name>[A-Za-z]+)\/(?<version>\d+(?:\.\d+)+)/],l={edg:"Edge",edga:"Edge",edgios:"Edge",opr:"Opera",opx:"Opera",crios:"Chrome",fxios:"Firefox",samsung:"SamsungBrowser",vivaldi:"Vivaldi",brave:"Brave"};for(const i of u){const a=e.match(i);if(a){let m=(n=a.groups)===null||n===void 0?void 0:n.name,f=((o=a.groups)===null||o===void 0?void 0:o.version)||((t=a.groups)===null||t===void 0?void 0:t.version1)||((r=a.groups)===null||r===void 0?void 0:r.version2);if(m||!(!((c=a.groups)===null||c===void 0)&&c.version1)&&!(!((s=a.groups)===null||s===void 0)&&s.version2)||(m="Safari"),!m&&i.source.includes("Opera Mini")&&(m="Opera Mini"),!m&&i.source.includes("Opera Mobi")&&(m="Opera Mobi"),!m&&i.source.includes("Opera")&&(m="Opera"),!m&&a[1]&&(m=a[1]),!f&&a[2]&&(f=a[2]),m)return{name:l[m.toLowerCase()]||m,version:f||"unknown"}}}return{name:"unknown",version:"unknown"}}function N(){if(typeof navigator>"u"||!navigator.userAgent)return!1;const n=navigator.userAgent;return/Mobi|Android|iPhone|iPod|IEMobile|Opera Mini|Opera Mobi|webOS|BlackBerry|Windows Phone/i.test(n)&&!/iPad/i.test(n)}function ne(){let n=[];const o={"prefers-contrast":["high","more","low","less","forced","no-preference"],"any-hover":["hover","none"],"any-pointer":["none","coarse","fine"],pointer:["none","coarse","fine"],hover:["hover","none"],update:["fast","slow"],"inverted-colors":["inverted","none"],"prefers-reduced-motion":["reduce","no-preference"],"prefers-reduced-transparency":["reduce","no-preference"],scripting:["none","initial-only","enabled"],"forced-colors":["active","none"]};return Object.keys(o).forEach((t=>{o[t].forEach((r=>{matchMedia(`(${t}: ${r})`).matches&&n.push(`${t}: ${r}`)}))})),n}function oe(){if(window.location.protocol==="https:"&&typeof window.ApplePaySession=="function")try{const n=window.ApplePaySession.supportsVersion;for(let o=15;o>0;o--)if(n(o))return o}catch{return 0}return 0}const te=L().name!=="SamsungBrowser"?1:3;let S,d=null;const V=["𝔄","𝔅","ℭ","𝔇","𝔈","𝔉","𝔸","𝔹","ℂ","𝔻","𝔼","𝔽"],j=["β","ψ","λ","ε","ζ","α","ξ","μ","ρ","φ","κ","τ","η","σ","ι","ω","γ","ν","χ","δ","θ","π","υ","ο"];function A(n,o){return`<math><mrow>${o}</mrow></math>`}function re(){let n="<mo>∏</mo>";return V.forEach(((o,t)=>{const r=2*t,c=j.slice(r,r+2);c.length===2&&(n+=`<mmultiscripts><mi>${o}</mi><none/><mi>${c[1]}</mi><mprescripts></mprescripts><mi>${c[0]}</mi><none/></mmultiscripts>`)})),A(0,`<munderover><mmultiscripts>${n}</mmultiscripts></munderover>`)}function ie(){const n=[];return V.forEach(((o,t)=>{const r=2*t,c=j.slice(r,r+2);c.length===2&&n.push(A(0,`<mmultiscripts><mi>${o}</mi><none/><mi>${c[1]}</mi><mprescripts></mprescripts><mi>${c[0]}</mi><none/></mmultiscripts>`))})),n}const ae={audio:async function(){return(async function(){return new Promise(((n,o)=>{try{const c=new(window.OfflineAudioContext||window.webkitOfflineAudioContext)(1,5e3,44100),s=c.createBufferSource(),e=c.createOscillator();e.frequency.value=1e3;const u=c.createDynamicsCompressor();let l;u.threshold.value=-50,u.knee.value=40,u.ratio.value=12,u.attack.value=0,u.release.value=.2,e.connect(u),u.connect(c.destination),e.start(),c.oncomplete=i=>{l=i.renderedBuffer.getChannelData(0),n({sampleHash:z(l),maxChannels:c.destination.maxChannelCount,channelCountMode:s.channelCountMode})},c.startRendering()}catch(t){console.error("Error creating audio fingerprint:",t),o(t)}}))})()},canvas:async function(){return new Promise((n=>{const o=Array.from({length:3},(()=>(function(){const t=document.createElement("canvas"),r=t.getContext("2d");if(!r)return new ImageData(1,1);t.width=B,t.height=20;const c=r.createLinearGradient(0,0,t.width,t.height);c.addColorStop(0,"red"),c.addColorStop(.16666666666666666,"orange"),c.addColorStop(.3333333333333333,"yellow"),c.addColorStop(.5,"green"),c.addColorStop(.6666666666666666,"blue"),c.addColorStop(.8333333333333334,"indigo"),c.addColorStop(1,"violet"),r.fillStyle=c,r.fillRect(0,0,t.width,t.height);const s="Random Text WMwmil10Oo";return r.font="23.123px Arial",r.fillStyle="black",r.fillText(s,-5,15),r.fillStyle="rgba(0, 0, 255, 0.5)",r.fillText(s,-3.3,17.7),r.beginPath(),r.moveTo(0,0),r.lineTo(2*t.width/7,t.height),r.strokeStyle="white",r.lineWidth=2,r.stroke(),r.getImageData(0,0,t.width,t.height)})()));n({commonPixelsHash:x(_(o,B,20).data.toString()).toString()})}))},fonts:async function(n){return new Promise(((o,t)=>{try{(async function(r){for(var c;!document.body;)await q(50);const s=document.createElement("iframe");s.setAttribute("frameBorder","0");const e=s.style;e.setProperty("position","fixed"),e.setProperty("display","block","important"),e.setProperty("visibility","visible"),e.setProperty("border","0"),e.setProperty("opacity","0"),s.src="about:blank",document.body.appendChild(s);const u=s.contentDocument||((c=s.contentWindow)===null||c===void 0?void 0:c.document);if(!u)throw new Error("Iframe document is not accessible");r({iframe:u}),setTimeout((()=>{document.body.removeChild(s)}),0)})((async({iframe:r})=>{const c=r.createElement("canvas").getContext("2d"),s=Y.map((u=>D(c,u)));let e={};J.forEach((u=>{const l=D(c,u);s.includes(l)||(e[u]=l)})),o(e)}))}catch{t({error:"unsupported"})}}))},hardware:function(){return new Promise(((n,o)=>{const t=navigator.deviceMemory!==void 0?navigator.deviceMemory:0,r=window.performance&&window.performance.memory?window.performance.memory:0;n({videocard:X(),architecture:Z(),deviceMemory:t.toString()||"undefined",jsHeapSizeLimit:r.jsHeapSizeLimit||0})}))},locales:function(){return new Promise((n=>{n({languages:navigator.language,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone})}))},math:function(){return new Promise((n=>{n({acos:Math.acos(.5),asin:k(Math.asin,-1,1,97),cos:k(Math.cos,0,Math.PI,97),largeCos:Math.cos(1e20),largeSin:Math.sin(1e20),largeTan:Math.tan(1e20),sin:k(Math.sin,-Math.PI,Math.PI,97),tan:k(Math.tan,0,2*Math.PI,97)})}))},permissions:async function(n){let o=n?.permissions_to_check||ee;const t=Array.from({length:3},(()=>(async function(r){const c={};for(const s of r)try{const e=await navigator.permissions.query({name:s});c[s]=e.state.toString()}catch{}return c})(o)));return Promise.all(t).then((r=>Q(r,o)))},plugins:async function(){const n=[];if(navigator.plugins)for(let o=0;o<navigator.plugins.length;o++){const t=navigator.plugins[o];n.push([t.name,t.filename,t.description].join("|"))}return new Promise((o=>{o({plugins:n})}))},screen:function(){return new Promise((n=>{const o={is_touchscreen:navigator.maxTouchPoints>0,maxTouchPoints:navigator.maxTouchPoints,colorDepth:screen.colorDepth,mediaMatches:ne()};N()&&navigator.maxTouchPoints>0&&(o.resolution=(function(){const t=window.screen.width,r=window.screen.height,c=Math.max(t,r).toString(),s=Math.min(t,r).toString();return`${c}x${s}`})()),n(o)}))},system:function(){return new Promise((n=>{const o=L();n({platform:window.navigator.platform,productSub:navigator.productSub,product:navigator.product,useragent:navigator.userAgent,hardwareConcurrency:navigator.hardwareConcurrency,browser:{name:o.name,version:o.version},mobile:N(),applePayVersion:oe(),cookieEnabled:window.navigator.cookieEnabled})}))},webgl:async function(){typeof document<"u"&&(S=document.createElement("canvas"),S.width=200,S.height=100,d=S.getContext("webgl"));try{if(!d)throw new Error("WebGL not supported");const n=Array.from({length:te},(()=>(function(){try{if(!d)throw new Error("WebGL not supported");const o=`
          attribute vec2 position;
          void main() {
              gl_Position = vec4(position, 0.0, 1.0);
          }
      `,t=`
          precision mediump float;
          void main() {
              gl_FragColor = vec4(0.812, 0.195, 0.553, 0.921); // Set line color
          }
      `,r=d.createShader(d.VERTEX_SHADER),c=d.createShader(d.FRAGMENT_SHADER);if(!r||!c)throw new Error("Failed to create shaders");if(d.shaderSource(r,o),d.shaderSource(c,t),d.compileShader(r),!d.getShaderParameter(r,d.COMPILE_STATUS))throw new Error("Vertex shader compilation failed: "+d.getShaderInfoLog(r));if(d.compileShader(c),!d.getShaderParameter(c,d.COMPILE_STATUS))throw new Error("Fragment shader compilation failed: "+d.getShaderInfoLog(c));const s=d.createProgram();if(!s)throw new Error("Failed to create shader program");if(d.attachShader(s,r),d.attachShader(s,c),d.linkProgram(s),!d.getProgramParameter(s,d.LINK_STATUS))throw new Error("Shader program linking failed: "+d.getProgramInfoLog(s));d.useProgram(s);const e=137,u=new Float32Array(4*e),l=2*Math.PI/e;for(let f=0;f<e;f++){const p=f*l;u[4*f]=0,u[4*f+1]=0,u[4*f+2]=Math.cos(p)*(S.width/2),u[4*f+3]=Math.sin(p)*(S.height/2)}const i=d.createBuffer();d.bindBuffer(d.ARRAY_BUFFER,i),d.bufferData(d.ARRAY_BUFFER,u,d.STATIC_DRAW);const a=d.getAttribLocation(s,"position");d.enableVertexAttribArray(a),d.vertexAttribPointer(a,2,d.FLOAT,!1,0,0),d.viewport(0,0,S.width,S.height),d.clearColor(0,0,0,1),d.clear(d.COLOR_BUFFER_BIT),d.drawArrays(d.LINES,0,2*e);const m=new Uint8ClampedArray(S.width*S.height*4);return d.readPixels(0,0,S.width,S.height,d.RGBA,d.UNSIGNED_BYTE,m),new ImageData(m,S.width,S.height)}catch{return new ImageData(1,1)}finally{d&&(d.bindBuffer(d.ARRAY_BUFFER,null),d.useProgram(null),d.viewport(0,0,d.drawingBufferWidth,d.drawingBufferHeight),d.clearColor(0,0,0,0))}})()));return{commonPixelsHash:x(_(n,S.width,S.height).data.toString()).toString()}}catch{return{webgl:"unsupported"}}}},se={webrtc:async function(){return new Promise((n=>{try{const o=window.RTCPeerConnection||window.webkitRTCPeerConnection||window.mozRTCPeerConnection;if(!o)return void n({supported:!1,error:"WebRTC not supported"});const t=new o({iceCandidatePoolSize:1,iceServers:[]});t.createDataChannel(""),(async()=>{try{const r={offerToReceiveAudio:!0,offerToReceiveVideo:!0},c=await t.createOffer(r);await t.setLocalDescription(c);const s=c.sdp||"",e=[...new Set((s.match(/extmap:\d+ [^\n\r]+/g)||[]).map((m=>m.replace(/extmap:\d+ /,""))))].sort(),u=m=>{const f=s.match(new RegExp(`m=${m} [^\\s]+ [^\\s]+ ([^\\n\\r]+)`));return f?f[1].split(" "):[]},l=(m,f)=>f.map((p=>{const h=new RegExp(`(rtpmap|fmtp|rtcp-fb):${p} (.+)`,"g"),g=[...s.matchAll(h)];if(!g.length)return null;const v={};return g.forEach((w=>{const[P,M,C]=w,T=C.split("/");M==="rtpmap"?(v.mimeType=`${m}/${T[0]}`,v.clockRate=+T[1],m==="audio"&&(v.channels=+T[2]||1)):M==="rtcp-fb"?(v.feedbackSupport=v.feedbackSupport||[],v.feedbackSupport.push(C)):M==="fmtp"&&(v.sdpFmtpLine=C)})),v})).filter(Boolean),i={audio:l("audio",u("audio")),video:l("video",u("video"))},a=await new Promise((m=>{const f=setTimeout((()=>{t.removeEventListener("icecandidate",p),t.close(),m({supported:!0,codecsSdp:i,extensions:e,timeout:!0})}),3e3),p=h=>{const g=h.candidate;g&&g.candidate&&(clearTimeout(f),t.removeEventListener("icecandidate",p),t.close(),m({supported:!0,codecsSdp:i,extensions:e,candidateType:g.type||""}))};t.addEventListener("icecandidate",p)}));n({hash:x(JSON.stringify(a))})}catch(r){t.close(),n({supported:!0,error:`WebRTC offer failed: ${r.message}`})}})()}catch(o){n({supported:!1,error:`WebRTC error: ${o.message}`})}}))},mathml:async function(){return new Promise((n=>{try{if(!(function(){try{const r=document.createElement("math");r.innerHTML="<mrow><mi>x</mi></mrow>",r.style.position="absolute",r.style.visibility="hidden",document.body.appendChild(r);const c=r.getBoundingClientRect();return document.body.removeChild(r),c.width>0&&c.height>0}catch{return!1}})())return void n({supported:!1,error:"MathML not supported"});const o=[A("integral","<msubsup><mo>∫</mo><mi>a</mi><mi>b</mi></msubsup><mfrac><mrow><mi>f</mi><mo>(</mo><mi>x</mi><mo>)</mo></mrow><mrow><mi>g</mi><mo>(</mo><mi>x</mi><mo>)</mo></mrow></mfrac><mi>dx</mi>"),A("fraction","<mfrac><mrow><mi>π</mi><mo>×</mo><msup><mi>r</mi><mn>2</mn></msup></mrow><mrow><mn>2</mn><mi>σ</mi></mrow></mfrac>"),A("matrix","<mo>[</mo><mtable><mtr><mtd><mi>α</mi></mtd><mtd><mi>β</mi></mtd></mtr><mtr><mtd><mi>γ</mi></mtd><mtd><mi>δ</mi></mtd></mtr></mtable><mo>]</mo>"),re(),...ie()],t={};o.forEach(((r,c)=>{t[`struct_${c}`]=(function(s){try{const e=document.createElement("math");e.innerHTML=s.replace(/<\/?math>/g,""),e.style.whiteSpace="nowrap",e.style.position="absolute",e.style.visibility="hidden",e.style.top="-9999px",document.body.appendChild(e);const u=e.getBoundingClientRect(),l=window.getComputedStyle(e),i={dimensions:{width:u.width,height:u.height},fontInfo:{fontFamily:l.fontFamily,fontSize:l.fontSize,fontWeight:l.fontWeight,fontStyle:l.fontStyle,lineHeight:l.lineHeight,fontVariant:l.fontVariant||"normal",fontStretch:l.fontStretch||"normal",fontSizeAdjust:l.fontSizeAdjust||"none",textRendering:l.textRendering||"auto",fontFeatureSettings:l.fontFeatureSettings||"normal",fontVariantNumeric:l.fontVariantNumeric||"normal",fontKerning:l.fontKerning||"auto"}};return document.body.removeChild(e),i}catch(e){return{error:e.message}}})(r)})),n({hash:x(JSON.stringify(t))})}catch(o){n({supported:!1,error:`MathML error: ${o.message}`})}}))}},W={},ce={timeout:"true"},le=(n,o,t)=>{W[n]=o};function G(n,o){var t;let r=L();if(r.name==="unknown"&&n.system&&typeof n.system=="object"&&!Array.isArray(n.system)){const a=n.system.browser;if(a&&typeof a=="object"&&!Array.isArray(a)){const m=a;r={name:m.name||"unknown",version:m.version||"unknown"}}}const c=r.name.toLowerCase(),s=r.version.split(".")[0]||"0",e=parseInt(s,10),u=[...o?.exclude||[]],l=o?.stabilize||[],i=o?.include||[];for(const a of l){const m=H[a];if(m)for(const f of m){const p=!("browsers"in f),h=!p&&((t=f.browsers)===null||t===void 0?void 0:t.some((g=>{const v=g.match(/(.+?)(>=)(\d+)/);if(v){const[,w,,P]=v,M=parseInt(P,10);return c===w&&e>=M}return c===g})));(p||h)&&u.push(...f.exclude)}}return(function a(m,f=""){const p={};for(const[h,g]of Object.entries(m)){const v=f?`${f}.${h}`:h;if(typeof g!="object"||Array.isArray(g)||g===null){const w=u.some((M=>v.startsWith(M))),P=i.some((M=>v.startsWith(M)));w&&!P||(p[h]=g)}else{const w=a(g,v);Object.keys(w).length>0&&(p[h]=w)}}return p})(n)}const F="thumbmark_visitor_id";let E=null,R=null;const ue=(n,o)=>{if(n.cache_api_call&&R)return Promise.resolve(R);if(E)return E;const t=`${U}/thumbmark`,r=(function(){try{return localStorage.getItem(F)}catch{return null}})(),c={components:o,options:n,clientHash:x(JSON.stringify(o)),version:"1.3.0"};r&&(c.visitorId=r);const s=fetch(t,{method:"POST",headers:{"x-api-key":n.api_key,Authorization:"custom-authorized","Content-Type":"application/json"},body:JSON.stringify(c)}).then((l=>{if(!l.ok)throw l.status===403?new Error("INVALID_API_KEY"):new Error(`HTTP error! status: ${l.status}`);return l.json()})).then((l=>(l.visitorId&&l.visitorId!==r&&(function(i){try{localStorage.setItem(F,i)}catch{}})(l.visitorId),R=l,E=null,l))).catch((l=>{if(console.error("Error fetching pro data",l),E=null,l.message==="INVALID_API_KEY")throw l;return null})),e=n.timeout||5e3,u=new Promise((l=>{setTimeout((()=>{l({info:{timed_out:!0},version:"1.3.0"})}),e)}));return E=Promise.race([s,u]),E};async function me(n){const o={...O,...n},t=!sessionStorage.getItem("_tmjs_l")&&Math.random()<1e-4,r={...ae,...W},{elapsed:c,resolvedComponents:s}=await $(r,o);let e={};if(t||o.experimental){const{resolvedComponents:h}=await $(se,o);e=h}const u=o.api_key?ue(o,s):null;let l=null;if(u)try{l=await u}catch(h){if(h instanceof Error&&h.message==="INVALID_API_KEY")return{error:"Invalid API key or quota exceeded",components:{},info:{},version:"1.3.0",thumbmark:""};throw h}const i=o.performance?{elapsed:c}:{},a=G(l?.components||{},o),m={...s,...a},f=l?.info||{uniqueness:{score:"api only"}},p=x(JSON.stringify(m));return t&&(async function(h,g,v,w={}){var P;const M=`${U}/log`,C={thumbmark:h,components:g,experimental:w,version:"1.3.0",options:v,path:(P=window?.location)===null||P===void 0?void 0:P.pathname};if(!sessionStorage.getItem("_tmjs_l")&&Math.random()<1e-4){sessionStorage.setItem("_tmjs_l","1");try{await fetch(M,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(C)})}catch{}}})(p,m,o,e).catch((()=>{})),{...l?.visitorId&&{visitorId:l.visitorId},thumbmark:p,components:m,info:f,version:"1.3.0",...i,...Object.keys(e).length>0&&o.experimental&&{experimental:e}}}async function $(n,o){const t={...O,...o},r=Object.entries(n).filter((([a])=>{var m;return!(!((m=t?.exclude)===null||m===void 0)&&m.includes(a))})).filter((([a])=>{var m,f,p,h;return!((m=t?.include)===null||m===void 0)&&m.some((g=>g.includes(".")))?(f=t?.include)===null||f===void 0?void 0:f.some((g=>g.startsWith(a))):((p=t?.include)===null||p===void 0?void 0:p.length)===0||((h=t?.include)===null||h===void 0?void 0:h.includes(a))})),c=r.map((([a])=>a)),s=r.map((([a,m])=>m(o))),e=await(function(a,m,f){return Promise.all(a.map((p=>{const h=performance.now();return Promise.race([p.then((w=>({value:w,elapsed:performance.now()-h}))),(g=m,v=f,new Promise((w=>{setTimeout((()=>w(v)),g)}))).then((w=>({value:w,elapsed:performance.now()-h})))]);var g,v})))})(s,t?.timeout||5e3,ce),u={},l={};e.forEach(((a,m)=>{var f;a.value!=null&&(l[c[m]]=a.value,u[c[m]]=(f=a.elapsed)!==null&&f!==void 0?f:0)}));const i=G(l,t);return{elapsed:u,resolvedComponents:i}}class de{constructor(o){this.options={...O,...o}}async get(o){return me({...this.options,...o})}getVersion(){return"1.3.0"}includeComponent(o,t){le(o,t)}}export{de as q};
