<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Compra Aprovada | Hadrielle Maria</title>

  <!-- ===== Pixel da UTMify ===== -->
  <script>
    window.pixelId = "68ab61e866c7db0ecbcc58d1"; // üëâ seu pixel da UTMify
    var a = document.createElement("script");
    a.setAttribute("async", "");
    a.setAttribute("defer", "");
    a.setAttribute("src", "https://cdn.utmify.com.br/scripts/pixel/pixel.js");
    document.head.appendChild(a);
  </script>

  <!-- ===== UTMify (captura UTMs) ===== -->
  <script
    src="https://cdn.utmify.com.br/scripts/utms/latest.js"
    data-utmify-prevent-xcod-sck
    data-utmify-prevent-subids
    async defer></script>

  <!-- üî• NOVO: Sistema de Tracking do Kwai -->
  <script src="/js/kwai-click-tracker.js"></script>

  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600&display=swap" rel="stylesheet">
  <style>
    body {
      margin: 0; padding: 0;
      font-family: 'Montserrat', sans-serif;
      background: #f5f6fa;
      display: flex; justify-content: center; align-items: center;
      flex-direction: column; min-height: 100vh;
    }
    .wrapper {
      background: #fff; width: 100%; max-width: 400px;
      padding: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      border-radius: 12px; text-align: center; margin: 20px;
    }
    .avatar {
      width: 120px; height: 120px; border-radius: 50%;
      object-fit: cover; margin: 0 auto;
    }
    .name { font-weight: 600; font-size: 18px; color: #333; margin-top: 10px; }
    .success { font-size: 17px; font-weight: 600; color: #008000; margin: 20px 0 10px; }
    .bio { margin: 16px 0; color: #333; font-size: 15px; line-height: 1.4; }
    .button {
      display: flex; align-items: center; justify-content: center; gap: 8px;
      background: #0088cc; color: #fff; font-weight: 600; padding: 12px;
      border: none; border-radius: 8px; text-decoration: none;
      width: fit-content; font-size: 16px; cursor: pointer; margin: 0 auto 20px;
    }
    .button svg { width: 20px; height: 20px; }
    .footer { font-size: 12px; color: #555; text-align: center; margin-top: 15px; padding: 0 10px; }
    
    /* üî• NOVO: Indicador de tracking */
    .tracking-status {
      font-size: 11px; color: #666; margin-top: 10px; padding: 5px;
      background: #f8f9fa; border-radius: 4px; border: 1px solid #e9ecef;
    }
  </style>
</head>
<body>
  <div class="wrapper">
    <img class="avatar" src="/compra-aprovada/images/hadrielle.jpg" alt="Hadrielle Maria">
    <div class="name">Hadrielle Maria</div>
    <div class="success">‚úÖ Compra Aprovada com Sucesso!</div>
    <div class="bio">
      Agora voc√™ tem acesso ao meu conte√∫do. Prepare-se para momentos intensos‚Ä¶<br><br>
      Clique abaixo e entre no grupo VIP.
    </div>

    <!-- üëâ Coloque o link do seu grupo VIP -->
    <a class="button" href="https://t.me/TEUVIP" rel="noopener">
      <svg viewBox="0 0 24 24" fill="#fff" aria-hidden="true">
        <path d="M12 0C5.373 0 0 5.373 0 12s5.373 12 12 12 12-5.373 12-12C24 5.373 18.627 0 12 0zm5.894 8.221-1.97 9.28c-.145.658-.537.818-1.084.508l-3-2.21-1.446 1.394c-.14.18-.357.295-.6.295-.002 0-.003 0-.005 0l.213-3.054 5.56-5.022c.24-.213-.054-.334-.373-.121l-6.869 4.326-2.96-.924c-.64-.203-.658-.64.135-.954l11.566-4.458c.538-.196 1.006.128.832.941z"/>
      </svg>
      ENTRAR NO GRUPO VIP
    </a>

    <!-- üî• NOVO: Status do tracking -->
    <div class="tracking-status" id="trackingStatus">
      üîç Verificando tracking...
    </div>

    <div class="footer">
      Todos os direitos reservados a Hadrielle Maria,<br>
      qualquer vazamento de imagem √© considerado crime sob<br>
      o C√≥digo Penal (Decreto-Lei 2.848, de 1940)
    </div>
  </div>

  <!-- üî• NOVO: Script de tracking autom√°tico -->
  <script>
    // Fun√ß√£o para capturar valor da compra da URL
    function getPurchaseValueFromUrl() {
      const urlParams = new URLSearchParams(window.location.search);
      const value = urlParams.get('value') || urlParams.get('purchase_value') || urlParams.get('amount');
      
      if (value) {
        // Converter para n√∫mero, aceitando v√≠rgula ou ponto como separador decimal
        const numericValue = parseFloat(value.replace(',', '.'));
        if (!isNaN(numericValue)) {
          console.log('üí∞ [COMPRA-APROVADA] Valor capturado da URL:', numericValue);
          return numericValue;
        }
      }
      
      // Fallback para valor padr√£o se n√£o conseguir capturar da URL
      console.warn('‚ö†Ô∏è [COMPRA-APROVADA] Valor n√£o encontrado na URL, usando fallback');
      return 19.98;
    }

    // Fun√ß√£o para enviar evento de compra aprovada
    async function sendPurchaseEvent() {
      try {
        // Aguardar o sistema de tracking carregar
        if (typeof window.KwaiTracker === 'undefined') {
          console.log('‚è≥ Aguardando sistema de tracking carregar...');
          setTimeout(sendPurchaseEvent, 1000);
          return;
        }

        // üî• NOVO: Capturar valor da compra da URL
        const purchaseValue = getPurchaseValueFromUrl();
        
        console.log('üéØ [COMPRA-APROVADA] Enviando evento EVENT_PURCHASE...', {
          value: purchaseValue,
          currency: 'BRL'
        });
        
        // Enviar evento de compra aprovada com valor da URL
        const result = await window.KwaiTracker.sendPurchase(purchaseValue, {
          currency: 'BRL',
          content_id: 'privacy_purchase_approved',
          content_name: 'Privacy - Assinatura Aprovada',
          content_category: 'Privacy'
        });

        if (result.success) {
          console.log('‚úÖ [COMPRA-APROVADA] Evento EVENT_PURCHASE enviado com sucesso');
          document.getElementById('trackingStatus').innerHTML = 
            `‚úÖ Tracking: Evento de compra enviado para Kwai (R$ ${purchaseValue.toFixed(2)})`;
        } else {
          console.warn('‚ö†Ô∏è [COMPRA-APROVADA] Falha ao enviar evento:', result.reason || result.error);
          document.getElementById('trackingStatus').innerHTML = 
            '‚ö†Ô∏è Tracking: Falha ao enviar evento - ' + (result.reason || result.error);
        }

      } catch (error) {
        console.error('‚ùå [COMPRA-APROVADA] Erro ao enviar evento:', error);
        document.getElementById('trackingStatus').innerHTML = 
          '‚ùå Tracking: Erro - ' + error.message;
      }
    }

    // Fun√ß√£o para verificar status do tracking
    function checkTrackingStatus() {
      const statusElement = document.getElementById('trackingStatus');
      
      if (typeof window.KwaiTracker === 'undefined') {
        statusElement.innerHTML = '‚è≥ Aguardando sistema de tracking...';
        return;
      }

      const hasClickId = window.KwaiTracker.hasValidClickId();
      const clickId = window.KwaiTracker.getClickId();

      if (hasClickId && clickId) {
        statusElement.innerHTML = 
          '‚úÖ Tracking: Click ID v√°lido - ' + clickId.substring(0, 10) + '...';
        
        // Enviar evento de compra ap√≥s 2 segundos
        setTimeout(sendPurchaseEvent, 2000);
      } else {
        statusElement.innerHTML = '‚ö†Ô∏è Tracking: Nenhum Click ID v√°lido encontrado';
      }
    }

    // Verificar status quando a p√°gina carregar
    document.addEventListener('DOMContentLoaded', () => {
      console.log('üéØ [COMPRA-APROVADA] P√°gina carregada, verificando tracking...');
      
      // Verificar status imediatamente
      checkTrackingStatus();
      
      // Verificar novamente ap√≥s 3 segundos (caso o tracking carregue depois)
      setTimeout(checkTrackingStatus, 3000);
    });

    // Log de erros
    window.addEventListener('error', (event) => {
      console.error('‚ùå [COMPRA-APROVADA] Erro JavaScript:', event.message);
    });

    window.addEventListener('unhandledrejection', (event) => {
      console.error('‚ùå [COMPRA-APROVADA] Promise rejeitada:', event.reason);
    });
  </script>
</body>
</html>
